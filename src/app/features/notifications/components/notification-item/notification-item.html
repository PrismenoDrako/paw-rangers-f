<article class="notification-card" [ngClass]="'notification-card--' + (notification.type || 'default')" (click)="onCardClick()">
  <div
    class="notification-avatar"
    [ngClass]="[
      notification.type !== 'mascota' ? 'notification-avatar--icon' : '',
      notification.type !== 'mascota' ? 'notification-avatar--' + (notification.category || 'neutral') : ''
    ]">
    <ng-container *ngIf="notification.type === 'mascota' && notification.image; else avatarIcon">
      <div class="avatar-image-wrapper">
        <img [src]="resolveImage(notification.image)" [alt]="notification.message" />
      </div>
    </ng-container>

    <ng-template #avatarIcon>
      <ng-container *ngIf="categoryConfig.iconImage; else avatarIconSvg">
        <img class="avatar-icon-img" [src]="resolveImage(categoryConfig.iconImage)" [alt]="categoryConfig.label" />
      </ng-container>

      <ng-template #avatarIconSvg>
        <ng-container [ngSwitch]="categoryConfig.icon">
          <svg *ngSwitchCase="'alert'" class="avatar-icon" viewBox="0 0 48 48" aria-hidden="true">
            <circle cx="24" cy="24" r="20" fill="none" stroke="currentColor" stroke-width="3" />
            <path d="M24 14v12" stroke="currentColor" stroke-width="3" stroke-linecap="round" />
            <circle cx="24" cy="32" r="2" fill="currentColor" />
          </svg>
          <svg *ngSwitchCase="'found'" class="avatar-icon" viewBox="0 0 48 48" aria-hidden="true">
            <path d="M12 22c0-6 4-10 12-10s12 4 12 10-5 14-12 18C17 36 12 28 12 22Z" fill="none"
              stroke="currentColor" stroke-width="3" stroke-linejoin="round" />
          </svg>
          <svg *ngSwitchCase="'like'" class="avatar-icon" viewBox="0 0 48 48" aria-hidden="true">
            <path
              d="M24 41s-14-7.7-14-18a8 8 0 0 1 14-5.3A8 8 0 0 1 38 23c0 10.3-14 18-14 18Z"
              fill="none" stroke="currentColor" stroke-width="3" stroke-linejoin="round" />
          </svg>
          <svg *ngSwitchCase="'reply'" class="avatar-icon" viewBox="0 0 48 48" aria-hidden="true">
            <path
              d="M40 12H12a6 6 0 0 0-6 6v9a6 6 0 0 0 6 6h4v7l8-7h16a6 6 0 0 0 6-6v-9a6 6 0 0 0-6-6Z"
              fill="none" stroke="currentColor" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" />
          </svg>
          <svg *ngSwitchCase="'mention'" class="avatar-icon" viewBox="0 0 48 48" aria-hidden="true">
            <circle cx="24" cy="24" r="18" fill="none" stroke="currentColor" stroke-width="3" />
            <path d="M24 18c-4 0-7 2.3-7 6s3 6 7 6c2.1 0 3.8-.7 5-2 .8-.9 1.2-2 1.2-3.3v-.7c0-1.2-.8-2-2-2-1 0-1.9.6-2.2 1.7h-.7c-.3-1.2-1.2-1.7-2.3-1.7-1.5 0-2.7 1.1-2.7 2.8s1.2 2.8 2.7 2.8c.9 0 1.6-.3 2.1-.9v-1.3c0-.5.4-.9.9-.9.6 0 1 .4 1 .9v.6c0 2.2-1.7 3.7-4.4 3.7-3.1 0-5.1-1.8-5.1-4.6S20.6 19 24 19c3.1 0 5.1 1.8 5.1 4.6v.7c0 .4.3.7.7.7s.7-.3.7-.7v-.7C30.5 20.3 27.6 18 24 18Z"
              fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
          <svg *ngSwitchCase="'clock'" class="avatar-icon" viewBox="0 0 48 48" aria-hidden="true">
            <circle cx="24" cy="24" r="20" fill="none" stroke="currentColor" stroke-width="3" />
            <path d="M24 16v10l6 4" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round"
              stroke-linejoin="round" />
          </svg>
          <svg *ngSwitchDefault class="avatar-icon" viewBox="0 0 48 48" aria-hidden="true">
            <circle cx="24" cy="24" r="20" fill="none" stroke="currentColor" stroke-width="3" />
            <path d="M24 16v10l6 4" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round"
              stroke-linejoin="round" />
          </svg>
        </ng-container>
      </ng-template>
    </ng-template>
  </div>

  <div class="notification-body">
    <div class="notification-body__head">
      <h4>{{ notification.message }}</h4>
      <button
        *ngIf="notification.targetUrl"
        type="button"
        class="open-detail-button"
        aria-label="Ver detalle de la notificaciÃ³n"
        (click)="onOpenDetail($event)">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M5 19h8a2 2 0 0 0 2-2v-3" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          <path d="M10 14 19 5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          <path d="M14 5h5v5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
      </button>
    </div>

    <p class="notification-context" *ngIf="notification.context">
      {{ notification.context }}
    </p>

    <div class="notification-body__meta">
      <div class="meta-pill" *ngIf="notification.type === 'mascota'" [ngClass]="categoryConfig.pillClass">
        <ng-container *ngIf="categoryConfig.iconImage; else metaIconSvg">
          <img class="meta-icon-img" [src]="resolveImage(categoryConfig.iconImage)" [alt]="categoryConfig.label" />
        </ng-container>
        <ng-template #metaIconSvg>
          <ng-container [ngSwitch]="categoryConfig.icon">
            <svg *ngSwitchCase="'alert'" class="meta-icon" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M1.5 20.5h21L12 3.5 1.5 20.5z" fill="none" stroke="currentColor" stroke-width="1.8"
                stroke-linejoin="round" />
              <path d="M12 9v5" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" />
              <circle cx="12" cy="17" r="1" fill="currentColor" />
            </svg>
            <svg *ngSwitchCase="'found'" class="meta-icon" viewBox="0 0 24 24" aria-hidden="true">
              <circle cx="12" cy="14.5" r="3.2" fill="none" stroke="currentColor" stroke-width="1.6" />
              <circle cx="7.5" cy="10" r="1.8" fill="currentColor" />
              <circle cx="16.5" cy="10" r="1.8" fill="currentColor" />
              <circle cx="9.5" cy="7.5" r="1.4" fill="currentColor" />
              <circle cx="14.5" cy="7.5" r="1.4" fill="currentColor" />
            </svg>
            <svg *ngSwitchCase="'like'" class="meta-icon" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M12 4a8 8 0 1 1-8 8" fill="none" stroke="currentColor" stroke-width="1.8"
                stroke-linecap="round" />
              <path d="M12 8v5l3 2" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
            <svg *ngSwitchCase="'reply'" class="meta-icon" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M20 7H8a4 4 0 0 0-4 4v4a4 4 0 0 0 4 4h2v4l6-4h4a4 4 0 0 0 4-4v-4a4 4 0 0 0-4-4Z"
                fill="none" stroke="currentColor" stroke-width="1.8" stroke-linejoin="round" stroke-linecap="round" />
            </svg>
            <svg *ngSwitchCase="'mention'" class="meta-icon" viewBox="0 0 24 24" aria-hidden="true">
              <circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="1.8" />
              <path d="M12 8c-2.5 0-4.5 1.4-4.5 3.7S9.5 15.4 12 15.4c1.3 0 2.4-.4 3.2-1.3.5-.6.8-1.4.8-2.3v-.5c0-.9-.6-1.5-1.5-1.5-.8 0-1.5.5-1.7 1.3h-.5c-.2-.9-1-.3-1.8-.3-1.1 0-1.9.7-1.9 1.9s.8 1.9 1.9 1.9c.6 0 1.1-.2 1.5-.6v-1c0-.4.3-.7.7-.7s.7.3.7.7v.4c0 1.6-1.3 2.7-3.3 2.7-2.4 0-4-1.4-4-3.6S9.1 7.6 12 7.6c2.9 0 4.8 1.7 4.8 4.1v.6c0 .4.3.6.6.6s.6-.3.6-.6v-.6C18 9.2 15.4 8 12 8Z"
                fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            <svg *ngSwitchDefault class="meta-icon" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M12 4a8 8 0 1 1-8 8" fill="none" stroke="currentColor" stroke-width="1.8"
                stroke-linecap="round" />
              <path d="M12 8v5l3 2" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
          </ng-container>
        </ng-template>

        <span class="meta-label">{{ categoryConfig.label }}</span>
      </div>

      <div class="meta-pill meta-pill--time">
        <svg class="meta-icon" viewBox="0 0 24 24" aria-hidden="true">
          <circle cx="12" cy="12" r="8" fill="none" stroke="currentColor" stroke-width="1.8" />
          <path d="M12 8v5l3 2" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"
            stroke-linejoin="round" />
        </svg>
        <span class="meta-label">{{ notification.timestamp }}</span>
      </div>
    </div>
  </div>
</article>
