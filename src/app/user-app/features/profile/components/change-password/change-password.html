<div class="password-card-container">

    <div class="header">
        <h2>Cambiar Contraseña</h2>
        <p>Actualiza tu contraseña de forma segura</p>
    </div>

    <form [formGroup]="passwordForm" (ngSubmit)="onSubmit()" class="p-fluid form-content">

        <!-- Mensaje de información -->
        <p-message 
            severity="info" 
            text="La contraseña debe tener al menos 8 caracteres" 
            styleClass="mb-4 w-full">
        </p-message>

        <!-- Inputs de contraseña -->
        <div class="p-grid form-grid">
            
            <!-- Contraseña Actual -->
            <div class="p-col-12">
                <p-floatlabel>
                    <input 
                        pInputText 
                        formControlName="currentPassword" 
                        id="currentPassword"
                        [type]="showPasswords.current ? 'text' : 'password'"/>
                    <label for="currentPassword">Contraseña Actual</label>
                </p-floatlabel>
                <button 
                    type="button" 
                    class="toggle-password-btn"
                    (click)="togglePasswordVisibility('current')">
                    <i [class]="showPasswords.current ? 'pi pi-eye-slash' : 'pi pi-eye'"></i>
                </button>
                <div class="error-message" *ngIf="passwordForm.get('currentPassword')?.hasError('required') && passwordForm.get('currentPassword')?.touched">
                    La contraseña actual es requerida
                </div>
            </div>

            <!-- Nueva Contraseña -->
            <div class="p-col-12">
                <p-floatlabel>
                    <input 
                        pInputText 
                        formControlName="newPassword" 
                        id="newPassword"
                        [type]="showPasswords.new ? 'text' : 'password'"/>
                    <label for="newPassword">Nueva Contraseña</label>
                </p-floatlabel>
                <button 
                    type="button" 
                    class="toggle-password-btn"
                    (click)="togglePasswordVisibility('new')">
                    <i [class]="showPasswords.new ? 'pi pi-eye-slash' : 'pi pi-eye'"></i>
                </button>
                <div class="error-message" *ngIf="passwordForm.get('newPassword')?.hasError('minlength') && passwordForm.get('newPassword')?.touched">
                    Mínimo 8 caracteres
                </div>
            </div>

            <!-- Confirmar Contraseña -->
            <div class="p-col-12">
                <p-floatlabel>
                    <input 
                        pInputText 
                        formControlName="confirmPassword" 
                        id="confirmPassword"
                        [type]="showPasswords.confirm ? 'text' : 'password'"/>
                    <label for="confirmPassword">Confirmar Contraseña</label>
                </p-floatlabel>
                <button 
                    type="button" 
                    class="toggle-password-btn"
                    (click)="togglePasswordVisibility('confirm')">
                    <i [class]="showPasswords.confirm ? 'pi pi-eye-slash' : 'pi pi-eye'"></i>
                </button>
                <div class="error-message" *ngIf="passwordForm.hasError('passwordMismatch') && passwordForm.get('confirmPassword')?.touched">
                    Las contraseñas no coinciden
                </div>
            </div>

        </div>

        <!-- Botones -->
        <div class="footer-btns flex justify-content-end gap-2 mt-5">
            <p-button 
                label="Cancelar" 
                styleClass="btn-secondary"
                icon="pi pi-times"
                (onClick)="onCancel()">
            </p-button>

            <p-button 
                label="Cambiar Contraseña" 
                type="submit" 
                styleClass="btn-primary"
                icon="pi pi-check"
                [disabled]="!passwordForm.valid">
            </p-button>
        </div>

    </form>

</div>
